<section data-ng-controller="HomeController">
    <!--<nav class="top-navbar collapse navbar-collapse" collapse="!isCollapsed" role="navigation">-->
    <div class="top-navbar">
        <!--        <ul class="nav navbar-nav" data-ng-if="menu.shouldRender(authentication.user);">
            <li data-ng-repeat="item in menu.items | orderBy: 'position'" data-ng-if="item.shouldRender(authentication.user);" ng-switch="item.type" data-ng-class="{ active: $state.includes(item.state), dropdown: item.type === 'dropdown' }" class="{{item.class}}" dropdown="item.type === 'dropdown'">
                <a ng-switch-when="dropdown" class="dropdown-toggle" dropdown-toggle role="button">{{::item.title}}&nbsp;<span class="caret"></span></a>
                <ul ng-switch-when="dropdown" class="dropdown-menu">
                    <li data-ng-repeat="subitem in item.items | orderBy: 'position'" data-ng-if="subitem.shouldRender(authentication.user);" data-ui-sref-active="active">
                        <a data-ui-sref="{{subitem.state}}" data-ng-bind="subitem.title"></a>
                    </li>
                </ul>
                <a ng-switch-default data-ui-sref="{{item.state}}" data-ng-bind="item.title"></a>
            </li>
            <li>

            </li>
        </ul>-->
        <ul class="nav navbar-nav navbar-right" data-ng-show="authentication.user">
            <li class="dropdown" dropdown>
                <a class="dropdown-toggle user-header-dropdown-toggle" dropdown-toggle role="button">
                    <img data-ng-src="{{authentication.user.profileImageURL}}" alt="{{authentication.user.displayName}}" class="img-rounded small-profile-picture" /><b class="caret"></b>
                </a>
                <ul class="dropdown-menu" role="menu">
                    <li data-ui-sref-active="active">
                        <a data-ui-sref="settings.profile">
                            <strong><span data-ng-bind="authentication.user.displayName"></span></strong>
                            <br>
                            <span>Edit Profile</span>
                        </a>
                    </li>
                    <li class="nav-divider"></li>
                    <li data-ui-sref-active="active">
                        <a data-ui-sref="settings.picture">Change Profile Picture</a>
                    </li>
                    <li data-ui-sref-active="active" data-ng-show="authentication.user.provider === 'local'">
                        <a data-ui-sref="settings.password">Change Password</a>
                    </li>
                    <li data-ui-sref-active="active">
                        <a data-ui-sref="settings.accounts">Manage Social Accounts</a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="/api/auth/signout" target="_self">Signout</a>
                    </li>
                </ul>
            </li>
        </ul>
        <tabset class="main-tab-list" data-ng-show="authentication.user">
            <tab data-ng-repeat="ticket in tickets" class="ticket-tab" data-ng-controller="ArticlesController" active="true">
                <tab-heading>
                    <i class="glyphicon glyphicon-asterisk"></i> {{ticket.title}}
                </tab-heading>
                <form name="articleForm" class="form-horizontal" data-ng-submit="create(ticket.tabIndex)" novalidate>
                    <fieldset class="col-md-4">
                        <!--<div class="col-xs-10">
                            <label class="control-label" for="requester">Requester</label>
                            <div class="controls">
                                <select data-ng-model="ticket.requester" name="requester" class="form-control">
                                    <option data-ng-repeat="user in requesters" value="{{user._id}}">{{user.displayName}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-xs-10">
                            <label class="control-label" for="requester">Assignee</label>
                            <div class="controls">
                                <select data-ng-model="article.assignee" name="requester" class="form-control">
                                    <option data-ng-repeat="user in requesters" value="{{user._id}}">{{user.displayName}}</option>
                                </select>
                            </div>
                        </div>-->
                        <div class='container-fluid controls col-xs-10' ng-controller="TypeaheadCtrl">
                            <label class="control-label" for="requester">Requester</label>
                            <input type="text" data-ng-model="asyncSelected" typeahead-on-select="change(asyncSelected)" placeholder="Type to search" typeahead="user.displayName for user in getUser($viewValue)" typeahead-loading="loadingLocations" typeahead-no-results="noResults" class="form-control">
                            <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>
                            <div ng-show="noResults">
                              <i class="glyphicon glyphicon-remove"></i> No Results Found
                            </div>
                        </div>
                        <div class='container-fluid controls col-xs-10' ng-controller="TypeaheadCtrl">
                            <label class="control-label" for="requester">Assignee</label>
                            <input type="text" data-ng-model="asyncSelected" placeholder="Type to search" typeahead="user.displayName for user in getUser($viewValue)" typeahead-loading="loadingLocations" typeahead-no-results="noResults" class="form-control">
                            <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>
                            <div ng-show="noResults">
                              <i class="glyphicon glyphicon-remove"></i> No Results Found
                            </div>
                        </div>
                        <div class="col-xs-10">
                            <label class="control-label" for="type">Type</label>
                            <div class="controls">
                                <select name="type" class="form-control" data-ng-model="ticket.type">
                                    <option value=0>-</option>
                                    <option value=1>Question</option>
                                    <option value=2>Incident</option>
                                    <option value=3>Problem</option>
                                    <option value=4>Task</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-xs-10">
                            <label class="control-label" for="priority">Priority</label>
                            <div class="controls">
                                <select name="priority" id="priority" class="form-control" data-ng-model="ticket.priority">
                                    <option value=0>-</option>
                                    <option value=1>Low</option>
                                    <option value=2>Normal</option>
                                    <option value=3>High</option>
                                    <option value=4>Urgent</option>
                                </select>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="col-md-8">
                        <div>
                            <p data-ng-bind="ticket.created | date:'MM/dd/yyyy \'at\' h:mma'"></p>
                        </div>
                        <div class="form-group">
                            <div class="controls">
                                <!--<i class="glyphicon glyphicon-refresh well well-sm"></i>--><input name="title" type="text" data-ng-model="ticket.title" id="title" class="form-control" placeholder="Title">
                            </div>
                        </div>
                        <div>
                            <strong data-ng-bind="ticket.content"></strong>
                        </div>
                        <div class="form-group">
                            <label class="control-label" for="content">Add new reply</label>
                            <div class="controls">
                                <textarea name="newReply" data-ng-model="ticket.newReply" class="form-control" cols="30" rows="5" placeholder="Type to add reply"></textarea>
                            </div>
                        </div>
                        <div class="list-group">
                            <a data-ng-repeat="response in ticket.responses|orderBy: '-created' track by $index" class="list-group-item">
                                <small class="list-group-item-text">
                                    Posted on
                                    <span data-ng-bind="response.created | date:'mediumDate'"></span>
                                    by
                                    <span data-ng-bind="response.user.displayName"></span>
                                </small>
                                <p class="list-group-item-text" data-ng-bind="response.content"></p>
                            </a>
                        </div>
                        <div class="form-group bottom-right-fixed">
                            <input type="submit" class="btn btn-primary btn-lg btn-block">
                        </div>
                    </fieldset>
                </form>
            </tab>
            <!--<tab class="ticket-tab">
                <tab-heading>
                    <i class="glyphicon glyphicon-inbox"></i> Home Hommmmm
                </tab-heading>
                <iframe class="ticket-tab-content" src="/articles/create"></iframe>
            </tab>-->
            <tab>
                <tab-heading>
                    <span class="dropdown" dropdown>
                   <span class="dropdown-toggle user-header-dropdown-toggle" dropdown-toggle role="button">
                      <i class="glyphicon glyphicon-plus"></i> add
                   </span>
                    <ul class="create-menu dropdown-menu" role="menu">
                        <li data-ui-sref-active="disable" class="dropdown-group-title">
                            <a>New...</a>
                        </li>
                        <li class="divider"></li>
                        <li data-ui-sref-active="active" data-ng-click="createTicket()">
                            <a>Ticket</a>
                        </li>
                        <li data-ui-sref-active="active">
                            <a>User</a>
                        </li>
                        <li data-ui-sref-active="active">
                            <a>Organization</a>
                        </li>
                        <li data-ui-sref-active="active">
                            <a>Search</a>
                        </li>
                        <li data-ui-sref-active="disable" class="dropdown-group-title">
                            <a>Recent tickets...</a>
                        </li>
                        <li class="divider"></li>
                        <li data-ui-sref-active="active">
                            <a>Recent ticket #1</a>
                        </li>
                        <li data-ui-sref-active="active">
                            <a>Recent ticket #2</a>
                        </li>
                        <li data-ui-sref-active="active">
                            <a>Recent ticket #3</a>
                        </li>
                        <li data-ui-sref-active="active">
                            <a>Recent ticket #4</a>
                        </li>
                    </ul>
                    </span>
                </tab-heading>
            </tab>
        </tabset>
    </div>
</section>
